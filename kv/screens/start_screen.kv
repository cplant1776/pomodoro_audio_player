#===================================
# START SCREEN
#===================================
#: import C kivy.utils.get_color_from_hex

<StartScreenLabel@Label>:
    size_hint_y: None
    pos_hint: {'center_x': 0.5}
    height: "30dp"
    width: "100dp"
    text_size: self.size
    halign: 'left'
    outline_width: 1
    outline_color: 0,0,0,1

<StartScreenTextInput@TextInput>:
    size_hint: (None, None)
    height: "30dp"
    width: "30dp"
    write_tab: False
    input_filter: 'int'
    on_text: self.text = self.text and self.text[:2] or ''

<StartScreenSlider@Slider>:
    orientation: 'horizontal'
    min: 0
    max: 60

<StartScreen>:
    Label:
        id: start_banner
        text: "Pomodoro Timer"
        outline_color: (0, 0, 0)
        outline_width: 3
        size_hint_y: None
        pos_hint: {'top': 1, 'center_x': 0.5}
        font_size: "65dp"

    BoxLayout:
        orientation: 'vertical'
        pos_hint: {'top': 0.8, 'center_x': 0.5}
        size_hint: 0.4, 0.65
        spacing: "20dp"
        padding: "10dp"
        canvas.before:
            Color:
                rgba: 45/255, 45/255, 45/255, 1
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [50,]

        StartScreenLabel:
            id: w_i_label
            text: "Work Interval Duration"
            halign: 'center'
        BoxLayout:
            orientation: 'horizontal'
            StartScreenSlider:
                id: w_i_slider
                value: 25
            Label:
                id: w_i_textinput
                text: str(int(root.ids.w_i_slider.value))
                size_hint: 0.1, 1
        StartScreenLabel:
            id: r_i_label
            text: "Rest Interval Duration"
            halign: 'center'
        BoxLayout:
            orientation: 'horizontal'
            StartScreenSlider:
                id: r_i_slider
                value: 5
            Label:
                id: r_i_textinput
                text: str(int(root.ids.r_i_slider.value))
                size_hint: 0.1, 1
        StartScreenLabel:
            id: l_r_label
            text: "Long Rest Interval Duration"
            halign: 'center'
        BoxLayout:
            orientation: 'horizontal'
            StartScreenSlider:
                id: l_r_i_slider
                value: 15
            Label:
                id: l_r_i_textinput
                text: str(int(root.ids.l_r_i_slider.value))
                size_hint: 0.1, 1
        StartScreenLabel:
            id: num_of_intervals_label
            text: "Work Intervals per Long Rest"
            halign: 'center'
        BoxLayout:
            orientation: 'horizontal'
            StartScreenSlider:
                id: num_of_intervals_slider
                value: 4
                range: (1, 10)
            Label:
                id: num_of_intervals_textinput
                text: str(int(root.ids.num_of_intervals_slider.value))
                size_hint: 0.1, 1

    Button:
        size_hint: 0.2, 0.05
        pos_hint: {'center_x': 0.5, 'top': 0.1}
        text: "Next"
        outline_color: 0,0,0,1
        outline_width: 1
        on_release:
            root.check_values_validity(work_interval=w_i_textinput.text,rest_interval=r_i_textinput.text,long_rest_interval=l_r_i_textinput.text, num_of_intervals=num_of_intervals_textinput.text)

    Button:
        pos_hint: {"center_x": 0.9, "center_y": 0.1}
        size_hint: 0.1, 0.1
        background_color: 0, 0, 0, 0
        on_press:
            root.pop_help()
        Image:
            source: './assets/icons/help.png'
            y: self.parent.y
            x: self.parent.x
            allow_stretch: True
            width: self.parent.width
            height: self.parent.height


<FailedSubmissionPopup@ModalView>:
    size_hint: 0.75, 0.2
    pos_hint: {'top': 0.7}
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'
        spacing: '10dp'
        Widget:
            size_hint_y: 0.1
        Label:
            id: failed_submission_label
            pos_hint: {'top': 0.5}
            text: "failedsubmissionpopup placeholder"
            halign: 'center'
            outline_color: 0,0,0,1
            outline_width: 1

        BoxLayout:
            orientation: 'horizontal'
            Widget:
            Button:
                pos_hint: {'center_x': 0.5}
                size_hint: 1, 0.5
                id: dismiss_failed_popup
                text: "Yes"
                outline_color: 0,0,0,1
                outline_width: 1
                on_press:
                    app.root.ids.start_screen.change_screen()
                    root.dismiss()
            Widget:
            Button:
                pos_hint: {'center_x': 0.5}
                size_hint: 1, 0.5
                id: accept_failed_popup
                text: "Cancel"
                outline_color: 0,0,0,1
                outline_width: 1
                on_press: root.dismiss()

            Widget:
        Widget:
            size_hint_y: 0.1


<HelpPopup@ModalView>:
    size_hint: 0.75, 0.8
    pos_hint: {'top': 0.85}
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: help_label
            background_color: (0,0,0,0)
            foreground_color: (1,1,1,1)
            size_hint: 0.8, 0.75
            pos_hint: {'center_x': 0.5}
            text_size: self.width, None
            use_bubble: True
            readonly: True
        Button:
            text: "Close"
            border: 25, 25, 25, 25
            size_hint: 0.2, 0.1
            pos_hint: {"center_x": 0.5, "center_y": 0.1}
            on_press: root.dismiss()
        Widget:
            size_hint: 1, 0.025


#canvas.before:
#    Color:
#        rgba: 1,0,0,1
#    Rectangle:
#        pos: self.pos
#        size: self.size